#Read bike lane data
bikelane_data = st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp")
bikelane_data
bikelane_data %>%
select(segmentid, instdate, bikedir, lanecount, ft_facilit, tf_facilit)
bikelane_data %>%
select(segmentid, instdate, bikedir, lanecount, ft_facilit, tf_facilit) %>%
separate(instdate, sep = "-")
bikelane_data %>%
select(segmentid, instdate, bikedir, lanecount, ft_facilit, tf_facilit) %>%
separate(instdate, into = c("year", "month", "day"), sep = "-")
bikelane_data %>%
select(segmentid, instdate, bikedir, lanecount, ft_facilit, tf_facilit) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-")
bikelane_data %>%
select(segmentid, instdate, bikedir, lanecount, ft_facilit, tf_facilit) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011)
bikelane_data %>%
select(segmentid, instdate, bikedir, lanecount, ft_facilit, tf_facilit) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-")
bikelane_data %>%
select(segmentid, instdate, bikedir, lanecount, ft_facilit, tf_facilit) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011)
tm_shape(bikelane_data) + tm_borders()
tm_shape(bikelane_data) + tm_lines()
tm_shape(bikelane_data) + tm_lines() + tm_shape(nyc_shp) + tm_borders
tm_shape(bikelane_data) + tm_lines() + tm_shape(nyc_shp) + tm_borders()
bikelane_data %>%
select(instdate, bikedir, lanecount, ft_facilit, tf_facilit) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011)
#Reproject data
bikelane_data = st_transform(bikelane_data, 4269)
bikelane_data
#Read bike lane data
bikelane_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 4269)
bikelane_data
bikelane_data %>%
select(instdate, bikedir, lanecount, ft_facilit, tf_facilit) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011)
test = nyc_shp %>%
filter(GEOID == 36047002100)
test
st_intersects(test, bikelane_data)
out = st_intersects(test, bikelane_data)
out
out = st_intersection(test, bikelane_data)
out
out %>%
select(-segmentid) %>%
group_by(fromstreet, tostreet) %>%
mutate(n())
bikelane_data %>%
select(instdate, bikedir, lanecount, fromstreet, tostreet, ft_facilit, tf_facilit) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011)
bikelane_data %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011)
bikelane_data %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011) %>%
group_by(fromstreet, tostreet) %>%
summarize(geometry = st_union(geometry))
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(rgdal)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 4269)
lane_data = segment_data %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011) %>%
group_by(fromstreet, tostreet) %>%
summarize(geometry = st_union(geometry))
tm_shape(lane_data) + tm_lines()
tm_shape(segment_data) + tm_lines()
segment_data
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 4269) %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011) %>%
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 4269) %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011)
segment_data
tm_shape(segment_data) + tm_lines()
tm_shape(lane_data) + tm_lines()
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 4269) %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2020)
tm_shape(segment_data) + tm_lines()
test = nyc_shp %>%
filter(GEOID %in% c(36085001700))
test
st_intersection(test, lane_data)
test = nyc_shp %>%
filter(GEOID %in% c(36047002100))
test
st_intersection(test, lane_data)
out = st_intersection(test, lane_data)
out
out %>%
summarize(n_lanes = n())
out
out %>%
st_drop_geometry() %>%
summarize(n_lanes = n())
source('~/Desktop/Research/Gentrification/Code/Scripts/utils.R', echo=TRUE)
test = nyc_shp %>%
filter(GEOID %in% c(36047002100))
out = st_intersection(test, lane_data)
out %>%
st_drop_geometry() %>%
summarize(n_lanes = n())
out
tm_shape(lane_data) + tm_lines()
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(rgdal)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 4269)
lane_shp = segment_data %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011) %>%
group_by(fromstreet, tostreet) %>%
summarize(geometry = st_union(geometry))
lane_counts = map_dfr(nyc_centroids$GEOID, aggregate_lanes, tracts_shp = nyc_centroids, id_var = "GEOID", lanes_shp = lanes_shp)
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(rgdal)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 4269)
bikelanes_shp = segment_data %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011) %>%
group_by(fromstreet, tostreet) %>%
summarize(geometry = st_union(geometry))
lane_counts = map_dfr(nyc_centroids$GEOID, aggregate_lanes, tracts_shp = nyc_centroids, id_var = "GEOID", lanes_shp = bikelanes_shp)
lane_counts = map_dfr(nyc_centroids$GEOID, aggregate_lanes, tracts_shp = nyc_shp, id_var = "GEOID", lanes_shp = bikelanes_shp)
nyc_sho
nyc_shp
source('~/Desktop/Research/Gentrification/Code/Scripts/utils.R', echo=TRUE)
lane_counts = map_dfr(nyc_centroids$GEOID, aggregate_lanes, tracts_shp = nyc_shp, id_var = "GEOID", lanes_shp = bikelanes_shp)
lane_counts = map_dfr(nyc_shp$GEOID, aggregate_lanes, tracts_shp = nyc_shp, id_var = "GEOID", lanes_shp = bikelanes_shp)
test
st_intersection(test, bikelanes_shp)
st_intersection(test, bikelanes_shp) %>%
st_drop_geometry() %>%
summarize(n())
source('~/Desktop/Research/Gentrification/Code/Scripts/utils.R', echo=TRUE)
lane_counts = map_dfr(nyc_shp$GEOID, aggregate_lanes, tracts_shp = nyc_shp, id_var = "GEOID", lanes_shp = bikelanes_shp)
lane_counts
map_data = inner_join(nyc_shp, lane_counts, by = "GEOID")
tm_shape(map_data) + tm_polygons(col = "n_lanes")
source('~/Desktop/Research/Gentrification/Code/Scripts/utils.R', echo=TRUE)
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(rgdal)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 4269)
bikelanes_shp = segment_data %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011) %>%
group_by(fromstreet, tostreet) %>%
summarize(geometry = st_union(geometry))
lane_counts = map_dfr(nyc_shp$GEOID, aggregate_lanes, tracts_shp = nyc_shp, id_var = "GEOID", lanes_shp = bikelanes_shp)
write_csv(lane_counts, "CleanData/lane_counts.csv")
nyc_shp
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(rgdal)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 4269)
#Join bike lane segments
bikelanes_shp = segment_data %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011) %>%
group_by(fromstreet, tostreet) %>%
summarize(geometry = st_union(geometry))
#Create centroids
nyc_centroids = st_centroid(nyc_shp) %>%
filter(GEOID == 36085001700 | GEOID == 36047002100)
lane_counts = map_dfr(nyc_centroids$GEOID, aggregate_lanes, tracts_shp = nyc_centroids, id_var = "GEOID", lanes_shp = bikelanes_shp)
write_csv(lane_counts, "CleanData/lane_counts.csv")
lane_counts
nyc_centroids
st_buffer(nyc_shp)
st_buffer(nyc_shp, dist = 804)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 2263)
segment_data
st_buffer(st_centroids(segment_data))
st_buffer(st_centroid(segment_data))
st_buffer(st_centroid(segment_data), dist = 804)
segment_data
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
st_transform(nyc_shp, 2263)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 2263)
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(rgdal)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
st_transform(nyc_shp, 2263)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 2263)
map_data = st_buffer(st_centroid(nyc_shp), 804.672)
map_data
st_centroid(nyc_shp)
st_transform(st_centroid(nyc_shp),2263)
map_data = st_buffer(st_transform(st_centroid(nyc_shp),2263), 804.672)
map_data
tm_shape(map_data) + tm_borders()
map_data = st_buffer(st_transform(st_centroid(nyc_shp),2263), 2640)
tm_shape(map_data) + tm_borders()
st_area(map_data)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 4269)
segment_data
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(stars)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
nyc_shp = st_transform(nyc_shp, 2263)
#Read in subway stop data
subway_data = read_csv("RawData/station_entrances.csv")
#Create subway shapefile
subway_shp = subway_data %>%
gather(ID, Line, Route_1:Route_11) %>%
filter(!is.na(Line)) %>%
select(-ID, -Station_Name) %>%
distinct() %>%
st_as_sf(coords = c("Station_Longitude", "Station_Latitude"), crs = 2263)
#Create tract centroids
nyc_centroids = st_centroid(nyc_shp)
nyc_centroids
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(stars)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
nyc_shp = st_transform(nyc_shp, 2263)
#Read in subway stop data
subway_data = read_csv("RawData/station_entrances.csv")
#Create subway shapefile
subway_shp = subway_data %>%
gather(ID, Line, Route_1:Route_11) %>%
filter(!is.na(Line)) %>%
select(-ID, -Station_Name) %>%
distinct() %>%
st_as_sf(coords = c("Station_Longitude", "Station_Latitude"), crs = 2263)
#Create tract centroids
nyc_centroids = st_centroid(nyc_shp)
st_distance(nyc_centroids %>% filter(GEOID == 36047002100), subway_shp)
st_distance(subway_shp, nyc_centroids %>% filter(GEOID == 36047002100))
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(stars)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
nyc_shp = st_transform(nyc_shp, 4269)
#Read in subway stop data
subway_data = read_csv("RawData/station_entrances.csv")
#Create subway shapefile
subway_shp = subway_data %>%
gather(ID, Line, Route_1:Route_11) %>%
filter(!is.na(Line)) %>%
select(-ID, -Station_Name) %>%
distinct() %>%
st_as_sf(coords = c("Station_Longitude", "Station_Latitude"), crs = 4269)
#Create tract centroids
nyc_centroids = st_centroid(nyc_shp)
st_distance(subway_shp, nyc_centroids %>% filter(GEOID == 36047002100))
source('~/Desktop/Research/Gentrification/Code/Scripts/utils.R', echo=TRUE)
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(stars)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
nyc_shp = st_transform(nyc_shp, 4269)
#Read in subway stop data
subway_data = read_csv("RawData/station_entrances.csv")
#Create subway shapefile
subway_shp = subway_data %>%
gather(ID, Line, Route_1:Route_11) %>%
filter(!is.na(Line)) %>%
select(-ID, -Station_Name) %>%
distinct() %>%
st_as_sf(coords = c("Station_Longitude", "Station_Latitude"), crs = 4269)
#Create tract centroids
nyc_centroids = st_centroid(nyc_shp)
subway_counts = map_dfr(nyc_centroids$GEOID, aggregate_lines, tracts_shp = nyc_centroids, id_var = "GEOID", lines = subway_shp, line_var = "Line")
write_csv(subway_counts, "CleanData/subway_counts.csv")
subway_counts
subway_counts %>%
filter(GEOID == 36047002100)
source('~/Desktop/Research/Gentrification/Code/Scripts/utils.R', echo=TRUE)
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(rgdal)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
st_transform(nyc_shp, 2263)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 2263)
#Join bike lane segments
bikelanes_shp = segment_data %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011) %>%
group_by(fromstreet, tostreet) %>%
summarize(geometry = st_union(geometry))
#Create centroids
nyc_centroids = st_transform(st_centroid(nyc_shp), 2263)
nyc_centroids
nyc_centroids
bikelanes_shp
nyc_centroids
test = nyc_centroids %>%
filter(GEOID == 36047002100)
test = nyc_centroids %>%
filter(GEOID == 36047002100)
st_buffer(test, 2640)
st_intersection(st_buffer(test, 2640), bikelanes_shp)
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(rgdal)
source("Code/Scripts/utils.R")
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
select(-tract_area)
st_transform(nyc_shp, 2263)
#Read bike lane segment data
segment_data = st_transform(st_read("RawData/NYC_BICYCLE_NETWORK_18D_20200214_p/NYC_BICYCLE_NETWORK_18D_20200214.shp"), 2263)
#Join bike lane segments
bikelanes_shp = segment_data %>%
select(instdate, fromstreet, tostreet) %>%
separate(instdate, into = c("year", "month", "time"), sep = "-") %>%
filter(year <= 2011) %>%
group_by(fromstreet, tostreet) %>%
summarize(geometry = st_union(geometry))
#Create centroids
nyc_centroids = st_transform(st_centroid(nyc_shp), 2263)
lane_counts = map_dfr(nyc_centroids$GEOID, aggregate_lanes, tracts_shp = nyc_centroids, id_var = "GEOID", lanes_shp = bikelanes_shp)
write_csv(lane_counts, "CleanData/lane_counts.csv")
lane_counts
lane_counts %>%
filter(GEOID == 36047002100)
bikelanes_shp
tm_shape(inner_join(nyc_shp, lane_counts, by = "GEOID")) + tm_polygons(col = "n_lanes")
st_read("RawData/ARCHIVED - Park Properties/geo_export_8f368290-e930-487f-ad9a-f52ca03e0b1c.shp")
st_read("RawData/ARCHIVED\ -\ Parks\ Properties/geo_export_8f368290-e930-487f-ad9a-f52ca03e0b1c.shp")
st_read("RawData/Parks\ Properties/geo_export_a8b348d6-27dd-4f41-b3af-d0dbbd495aa3.shp")
