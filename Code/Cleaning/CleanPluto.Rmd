---
title: "Clean Pluto Data"
author: "Liam Purkey"
date: "5/18/2021"
output: html_document
---

#Setup File

```{r, setup, include=FALSE}
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
```

```{r}
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
library(furrr)
source("Code/Scripts/utils.R")
```

```{r}
#Read in pluto data
pluto = read_csv("RawData/pluto/bk11v2.txt")
```

```{r}
pluto %>%
  select(CT2010, ZoneDist1, Overlay1, LotArea) %>%
  filter(!is.na(CT2010)) %>%
  filter(!is.na(ZoneDist1)) %>%
  mutate(zone = case_when(grepl("R1|R2|R3|R4|R5", ZoneDist1) & !grepl("/", ZoneDist1) ~ "R1_R5",
                          grepl("R6|R7|R8|R9|R10", ZoneDist1) & !grepl("/", ZoneDist1) ~ "R6_R10",
                          grepl("C1|C2", Overlay1) ~ "C1_C2",
                          grepl("C4", ZoneDist1) ~ "C4",
                          grepl("C5|C6", ZoneDist1) ~ "C5_C6",
                          grepl("/", ZoneDist1) ~ "MR")) %>%
  filter(!is.na(zone)) %>%
  group_by(CT2010) %>%
  mutate(total_area = sum(as.numeric(LotArea))) %>%
  group_by(CT2010, zone) %>%
  summarise(zone_area = sum(as.numeric(LotArea)/total_area)) %>%
  ungroup() %>%
  arrange(CT2010)
```

```{r}
length(unique(pluto$CT2010))
```





