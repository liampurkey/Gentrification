---
title: "Clean Tree Data"
author: "Liam Purkey"
date: "5/6/2021"
output: html_document
---

#Setup File

```{r, setup, include=FALSE}
#Change root directory
knitr::opts_knit$set(root.dir = "/Users/liampurkey/Desktop/Research/Gentrification")
```

```{r}
#Load packages
library(magrittr)
library(readxl)
library(readr)
library(tidyverse)
library(sf)
library(spData)
library(tmap)
library(purrr)
source("Code/Scripts/utils.R")
```

```{r}
#Read in tract shapefile
nyc_shp = st_read("RawData/Boundaries/NewYork.shp") %>%
  select(-tract_area) %>%
  st_transform(4269)
```

```{r}
#Read in street tree data 
trees_shp = read_csv("RawData/2005_Street_Tree_Census.csv") %>%
  filter(status == "Excellent" | status == "Good") %>%
  filter(longitude != 0 & latitude != 0) %>%
  st_as_sf(coords = c("longitude", "latitude"), crs = 4269) %>%
  select(geometry)
```

#Aggregate Tree Count

```{r}
test = map_dfr(c(36047002100, 36085000600, 36085000700, 36085001800, 36085000300), aggregate_trees, tracts_shp = nyc_shp, id_var = "GEOID", trees_shp = trees_shp)
```

#Write Tree Data

```{r}
write_csv(tree_density, "CleanData/tree_density.csv")
```


